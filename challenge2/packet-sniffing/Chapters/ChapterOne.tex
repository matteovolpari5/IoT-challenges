Domanda 1
Confirmable put request 
coap && coap.type == 0 && coap.code == 3
45 frames
Response 
coap && (coap.code >= 128)
228 frames 
Dovrei matcharli per token/message id, troppi.
Quindi pyshark.

Domanda 2
Get request confirmable a coap.me
coap.type == 0 && coap.code == 1 && ip.dst==134.102.218.18
39 frames
Get non confirmable a coap.me
coap.type == 1 && coap.code == 1 && ip.dst==134.102.218.18
31 frames
Dovrei vedere a quale risorsa fanno riferimento e poi confrontare.
Troppo, quindi pyshark.

Domanda 3
dns.qry.name == "broker.hivemq.com"
::1 dovrebbe essere il loopback in ipv6, tipo 127.0.0.1 per ipv4

Filtro wireshark:
mqtt && mqtt.msgtype == 8 && ip.dst == 18.192.151.104 && mqtt.topic contains "#"

Ottieni 6 pacchetti.
Per ognuno prendi tcp stream:
N 375 - TCP stream = 8
N 2442 - TCP stream 15
N 3293 - TCP stream 20
N 3303 - TCP stream 15
N 3362 - TCP stream 3 
N 3693 - TCP stream 15 

Per ogni stream prendo il client id 
mqtt && mqtt.msgtype == 1 && tcp.stream == 3 
uguale per tutti gli stream, cambiando valore, ottengo client id 
Stream 3 - Client ID: cpoepjzkhibxgjiu
Stream 8 - Client ID: dzcxnwdqef
Stream 15 - Client ID: tukvxesuhe
Stream 20 - Client ID: fcthvjikxjul
Tutti diversi, 4 client.

Domanda 4
Filtro wireshark:
mqtt && mqtt.msgtype == 1 && mqtt.willtopic matches "^university"

Oppure:
mqtt && mqtt.msgtype == 1 && mqtt.willtopic
Ne escono 4 e li controllo, solo uno inizia per university 

Domanda 5:

mqtt && mqtt.msgtype== 1 && mqtt.willmsg
Ottengo 4 fram di tipo CONNECT che specificano un last will message e last will topic.

4	0.000117188	::1	::1	MQTT	176	Connect Command
196	2.116585177	10.0.2.15	5.196.78.28	MQTT	126	Connect Command
352	5.034840089	10.0.2.15	5.196.78.28	MQTT	123	Connect Command
557	7.043177949	10.0.2.15	5.196.78.28	MQTT	120	Connect Command

1
Will Topic: university/department12/room1/temperature
Will Message Length: 29
Will Message: 6572726f723a20612056495020436c69656e74206a7573742064696564
2
Will Topic: metaverse/room2/floor4
Will Message Length: 15
Will Message: 6572726f723a20706575697664716c
3
Will Topic: hospital/facility3/area3
Will Message Length: 15
Will Message: 6572726f723a20786c7a6171707464
4
Will Topic: metaverse/room2/room2
Will Message Length: 15
Will Message: 6572726f723a207a6a7a7772636470

Per il primo:
Messaggi pubblicati su quel topic:
mqtt && mqtt.msgtype==3 && mqtt.topic == "university/department12/room1/temperature" 
4 risultati
Messaggi pubblicati su quel topic con messaggio uguale a last will message:
mqtt && mqtt.msgtype==3 && mqtt.topic == "university/department12/room1/temperature" && mqtt.msg contains 6572726f723a20612056495020436c69656e74206a7573742064696564
Stessi 4 risultati
Però non ha retain true!
mqtt && mqtt.msgtype==3 && mqtt.topic == "university/department12/room1/temperature" && mqtt.msg contains 6572726f723a20612056495020436c69656e74206a7573742064696564 && mqtt.retain == 1
Nessun risultato

Devono avere il retain? Se sì, allora non sono last will, altrimenti???

Per quelli da 2 a 4:
5.196.78.28 è src solamente per PUBACK, PUBREC, CONNACK.
Filtro che estrae i messaggi pubblicati:
mqtt && ip.src == 5.196.78.28 && mqtt.msgtype == 3 
non ritorna risultati
Se non ha pubblicato nulla, non può aver mandato dei last will message.



















